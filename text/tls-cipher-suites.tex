\section{Cipher suites}

TLS is great in flexibility which provides for using various cryptographic primitives in a common framework. A selection of cryptographic primitives and their parameters is called \textit{cipher suite}.

A cipher suite is defined by the following attributes:

\begin{itemize}
  \item Key exchange algorithm
  \item Authentication algorithm
  \item Encryption algorithm
  \begin{itemize}
    \item cipher algorithm
    \item key size
    \item cipher mode
  \end{itemize}
  \item MAC algorithm
  \item Pseudorandom function
\end{itemize}

Cipher suite names are usually long, descriptive and consistent. They are made from names of underlying used algorithms.

\subsection{Key exchange}

Key exchange as defined in \autoref{toc/key-exchange} is used in TLS to establish a shared value called \textit{premaster secret}. The length of premaster secret depends on the key exchange algorithm. From the premaster secret is constructed a 48-byte shared value called \textit{master secret}, a value which is used in all subsequent operations affecting the security of the session.

Which key exchange is used depends on the negotiated suite. Once the suite is known, both sides know which algorithm to follow. In practice, there are four main key exchange algorithms:

\begin{description}
  \item[RSA] RSA is effectively the standard key exchange algorithm. It's universally supported but suffers from one serious problem: its design allows a passive attacker to decrypt all encrypted data, provided she has access to the server's private key. Because of this, the RSA key exchange is being slowly replaced with other algorithms, those that support forward secrecy. The RSA key exchange is a key transport algorithm; the client generates the premaster secret and transports it to the server, encrypted with the server's
public key.
  \item[DHE] Ephemeral Diffie-Hellman (DHE) key exchange is a well-established algorithm. It's liked because it provides forward secrecy but disliked because it's slow. DHE is a key agreement algorithm; the negotiating parties both contribute to the process and agree
on a common key. In TLS, DHE is commonly used with RSA authentication.
  \item[ECDHE] Ephemeral elliptic curve Diffie-Hellman (ECDHE) key exchange is based on elliptic curve cryptography, which is relatively new. It's liked because it's fast and provides forward secrecy. It's well supported only by modern clients. ECDHE is a key agreement algorithm conceptually similar to DHE. In TLS, ECDHE can be used with either RSA or ECDSA authentication. \cite{ristic2014bulletproof}
\end{description}

\subsection{Authentication}

Authentication is tightly coupled with key exchange in order to avoid repetition of costly cryptographic operations. In most cases, the basis for authentication will be public key cryptography (most commonly RSA, but sometimes ECDSA) by X509 certificates. Once the certificate is validated, the client has a known public key to work with. After that, it's down to the particular key exchange method to use the public key in some way to authenticate the other side.

During the RSA key exchange, the client generates a random value as the premaster secret and sends it encrypted with the server's public key. The server decrypts the message to obtain the premaster secret. The authentication is implicit. It is assumed that only the server in possession of the corresponding private key can retrieve the premaster secret.

During the DHE and ECDHE exchanges, the server contribute to the key exchange with its random parameters, signed with its private key. The client can validate it by the corresponding public key.

\subsection{Encryption}

\subsection{Message authentication code}

\subsection{Pseudorandom function}
