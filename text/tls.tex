\chapter{Transport Layer Security (TLS) protocol}

\input{figures/network-model.tex}

TLS is a security protocol used in almost 100\% of secure Internet transactions. Essentially, TLS transforms a typical reliable transport protocol (such as TCP) into a secure communication channel suitable (see \autoref{toc/secure-channel}) for sending sensitive messages. TLS does not indicate which cryptographic algorithms need to be used. Instead of it, TLS serves as a framework establishing and maintaining a secure comminucation channel.

Adding encryption to an existing protocol is best performed in a transparent way, so that applications using the protocol library do not need to change their code to support encryption. A perfect example is HTTP protocol. A HTTP library can support both plaintext HTTP and encrypted HTTPS, and an application using this library can select the protocol simply in an URL, by specifying \textit{http://} or \textit{https://} respectively. See \autoref{figure/network-model}.

\input{text/tls-intro.tex}
\input{text/tls-standardization.tex}
%\input{text/tls-history.tex}
\input{text/tls-cipher-suites.tex}

\section{Protocol details}

\input{text/tls-handshake.tex}

\subsection{ChangeCipherSpec protocol}

The ChangeCipherSpec message is a signal that the sending side obtained enough information to generate the connection parameters, the encryption keys, and is switching to encryption. Client and server both send this message when the time is right.

\subsection{Alert protocol}

Alerts are intended to use a simple notification mechanism to inform the other side in the communication of exceptional circumstances. Theyâ€™re generally used for error messages.

\subsection{Data protocol}

The application data protocol carries application messages, which are just opaque byte arrays as far as TLS is concerned. These messages are packaged, fragmented, and encrypted by the record layer, using the current connection security parameters.

\input{text/tls-libs.tex}
