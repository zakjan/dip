\begin{figure}[b]
  \centering

  \begin{subfigure}[b]{0.45\textwidth}
    \centering
    \begin{tikzpicture}
      \node (f) [rect,minimum size=1.5*\nodeheight] {$S$};
      \coordinate (k) at ($(f)+(0,1)$);
      \coordinate (m) at ($(f)-(1,0)$);
      \coordinate (a) at ($(f)+(1,0)$);
      \path [line,->] (k) -- (f) node[at start,above]{$K_a$};
      \path [line,->] (m) -- (f) node[at start,left]{$m$};
      \path [line,->] (f) -- (a) node[at end,right]{$a$};
    \end{tikzpicture}
    \caption{Sign function}
    \bigskip
  \end{subfigure}
  \begin{subfigure}[b]{0.45\textwidth}
    \centering
    \begin{tikzpicture}
      \node (f) [rect,minimum size=1.5*\nodeheight] {$V$};
      \coordinate (k) at ($(f)+(0,1)$);
      \coordinate (m) at ($(f)-(1,0)$);
      \coordinate (a) at ($(f)-(1,0)$);
      \coordinate (r) at ($(f)+(1,0)$);
      \path [line,->] (k) -- (f) node[at start,above]{$K_a$};
      \path [line,->,transform canvas={yshift=0.5*\nodeheight}] (m) -- (f) node[at start,left]{$m$};
      \path [line,->,transform canvas={yshift=-0.5*\nodeheight}] (a) -- (f) node[at start,left]{$a$};
      \path [line,->] (f) -- (r) node[at end,right]{$\{0,1\}$};
    \end{tikzpicture}
    \caption{Verify function}
    \bigskip
  \end{subfigure}

  \begin{tikzpicture}
    \node (alice) [rect,left=2.5] {Alice};
    \node [align=center,below=0 of alice] {$S, K_a$ \\ $m, a := S(K_a, m)$};
    \node (bob) [rect,right=2.5] {Bob};
    \node [align=center,below=0 of bob] {$V, K_a$ \\ $m, a, V(K_a, m, a)?$};
    \path [line] (alice) -- (bob) node[near start,below]{$m, a$};
  \end{tikzpicture}

  \caption{Generic setting for authentication}
  \label{figure/authentication}
\end{figure}
